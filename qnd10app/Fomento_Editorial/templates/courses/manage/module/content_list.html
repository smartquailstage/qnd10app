{% extends "base.html" %}
{% load course %}
{% load static %}

{% block title %}
<ion-icon name="add-outline"></ion-icon> Base Técnica: {{ module.order|add:1 }}: {{ module.title }}
{% endblock %}

{% block content %}

  {% with course=module.course %}
  <div class="col-12 col-lg-7">
    <div class="product-info-section p-3">
      <h3 class="mt-3 mt-lg-0 mb-0">Convocatoria : {{ course.title }}</h3>
      <h4 class="mt-3 mt-lg-0 mb-0">Base Técnica : {{ module.title }}</h4>
      
  
      <div class="mt-3">
        <h6>Resumen:</h6>
        <p class="mb-0">{{ module.description }}</p>
      </div>
      <dl class="row mt-3">
        <dt class="col-sm-3">Número de bases técnicas</dt>
        <dd class="col-sm-9">{{ module.order|add:1 }}</dd>
        <dt class="col-sm-3">Última actualización:</dt>
        <dd class="col-sm-9">{{ module.created }}</dd>
      </dl>
  
  <h6 class="mb-0 text-uppercase">  <ion-icon name="add-outline"></ion-icon> Agregar contenidos a la base legal : {{ base.title }}</h6>
      <!--end row-->
      <div class="d-flex gap-2 mt-3">
        <a href="{% url "module_content_create" module.id  "text" %}" class="btn btn-light  btn-ecomm">
          <i class="bx bx-text"></i>  
        </a>
        <a href="{% url "module_content_create" module.id "image" %}" class="btn btn-light btn-ecomm">
          <i class="bx bx-image"></i>
        </a>
        <a href="{% url "module_content_create" module.id  "video" %}" class="btn btn-light btn-ecomm">
          <i class="bx bx-video"></i>
        </a>
        <a href="{% url "module_content_create" module.id "file" %}" class="btn btn-light btn-ecomm">
          <i class="bx bx-file"></i>
        </a>
      </div>
      <hr/>
  
    </div>
  </div>
  
  <h6 class="mb-0 text-uppercase">Contenido en bases legales inscritas en la convocatoria:</h6>
  <hr/>
  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table id="example" class="table table-striped table-bordered" style="width:100%">
          <thead>
            <tr>
              <th>N.-</th>
              <th>Título de base técnica</th>
              <th>Título de contenido en base técnica</th>
              <th>Tipo</th>
              <th>Configuraciones</th>
             
            </tr>
          </thead>
          <tbody>
            {% for m in course.modules.all %}
            {% for content in module.contents.all %}
                  {% with item=content.item %}
            <tr>
              <td>{{ m.order|add:1 }}</td>
              <td>
                <a href="">{{ m.title }}</a>
              </td>
              <td>
                <div data-id="{{ content.id }}">
                  
                  <p> <a href="{% url "module_content_update" module.id item|model_name item.id %}"  >{{ item }}</a></p>
                  <td>
                    {{ item|model_name   }}
                  </td>
                  
              <td>
                <form action="{% url "module_content_delete" content.id %}" method="post">
                  <input type="submit" value="Eliminar" type="button" class="btn btn-danger" >
                  {% csrf_token %}
                </form>
              </td>
              
                  
                  {% endwith %}
                </div>
                {% empty %}
                <p>This module has no contents yet.</p>
              {% endfor %}
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3">No se ha creado ningún contenido para esta base legal.</td>
            </tr>
            {% endfor %}
          </tbody>
           
          <tfoot>
            <tr>
              <th>Contenidos</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
  
  <h6 class="mb-0 text-uppercase">Bases legales inscritas en la convocatoria:</h6>
  <hr/>
  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table id="example" class="table table-striped table-bordered" style="width:100%">
          <thead>
            <tr>
              <th>N.-</th>
              <th>Titulo de Base legal</th>
              <th>Categoria legal</th>
              <th>Fecha de creación</th>
            </tr>
          </thead>
          <tbody>
            {% for m in course.modules.all %}
            <tr>
              <td data-id="{{ m.id }}" {% if m == base %}class="selected"{% endif %}>
                <a href="{% url "module_content_list" m.id %}">{{ m.order|add:1 }}</a>
              </td>
              <td>
                <a href="{% url "course_module_update" course.id %}">{{ m.title }}</a>
              </td>
              <td>{{ course.subject }}</td>
              <td>{{ m.created }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4">No se ha creado ninguna base legal para esta convocatoria.</td>
            </tr>
            {% endfor %}
          </tbody>
           
          <tfoot>
            <tr>
              <th>Número de Base legal</th>
              <th>Titulo de Base legal</th>
              <th>Categoria legal</th>
              <th>Fecha de creación</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

{% endwith %}
{% endblock %}
